import{g as e,a as t,c as n,s}from"./chunks/api.js";const l={"zh-CN":{deleteAllTranslations:"一键删除全部翻译",translateSelectedSentence:"翻译选中的句子",simplifySelectedEnglish:"简化选中的英文 (Simplify Selection)"},en:{deleteAllTranslations:"Delete All Translations",translateSelectedSentence:"Translate Selected Sentence",simplifySelectedEnglish:"Simplify Selected English"},ja:{deleteAllTranslations:"すべての翻訳を削除",translateSelectedSentence:"選択した文を翻訳",simplifySelectedEnglish:"選択した英語を簡素化"},ko:{deleteAllTranslations:"모든 번역 삭제",translateSelectedSentence:"선택한 문장 번역",simplifySelectedEnglish:"선택한 영어 단순화"}};function c(e,t="zh-CN"){const n=l[t];return n&&n[e]?n[e]:l["zh-CN"][e]}async function a(){try{const e=(await chrome.storage.sync.get(["language"])).language||"zh-CN",t=c("deleteAllTranslations",e),n=c("translateSelectedSentence",e),s=c("simplifySelectedEnglish",e);chrome.contextMenus.removeAll((()=>{chrome.contextMenus.create({id:"deleteAllTranslations",title:t,contexts:["page"]}),chrome.contextMenus.create({id:"translateSelectedSentence",title:n,contexts:["selection"]}),chrome.contextMenus.create({id:"simplifySelectedEnglish",title:s,contexts:["selection"]})}))}catch(e){chrome.contextMenus.removeAll((()=>{chrome.contextMenus.create({id:"deleteAllTranslations",title:c("deleteAllTranslations","zh-CN"),contexts:["page"]}),chrome.contextMenus.create({id:"translateSelectedSentence",title:c("translateSelectedSentence","zh-CN"),contexts:["selection"]}),chrome.contextMenus.create({id:"simplifySelectedEnglish",title:c("simplifySelectedEnglish","zh-CN"),contexts:["selection"]})}))}}chrome.runtime.onInstalled.addListener((l=>{if("install"===l.reason){const t={targetLanguage:"zh",language:"zh-CN",sourceLanguage:"en",enableContextTranslation:!1,modelProvider:"wordwiseCloud",contextTranslationApiUrl:`${e()}/translate`,contextTranslationModel:"",apiKeys:{openai:"",qwen:"",deepseek:"",anthropic:"",openrouter:"",custom:"",volcengine:"",zhipu:""},customModelNames:{openai:"",qwen:"",deepseek:"",anthropic:"",openrouter:"",custom:"",volcengine:"",zhipu:""}},n={settings:t,...t};chrome.storage.sync.set(n,(()=>{}))}else l.reason;a(),function(){const e=t();s(e).catch((e=>{})),setInterval((()=>{n(e).catch((e=>{}))}),3e5)}()})),chrome.tabs.onUpdated.addListener(((e,s,l)=>{if("complete"===s.status){const e=t();l.url&&l.url.includes(e.replace(/^https?:\/\//,""))&&n(e).catch((e=>{}))}})),chrome.storage.onChanged.addListener(((e,t)=>{"sync"===t&&e.language&&a()})),chrome.contextMenus.onClicked.addListener(((e,t)=>{"deleteAllTranslations"===e.menuItemId?chrome.tabs.sendMessage(t.id,{type:"DELETE_ALL_TRANSLATIONS"}).catch((e=>{})):"translateSelectedSentence"===e.menuItemId?chrome.tabs.sendMessage(t.id,{type:"TRANSLATE_SELECTED_SENTENCE",text:e.selectionText}).catch((e=>{})):"simplifySelectedEnglish"===e.menuItemId&&chrome.tabs.sendMessage(t.id,{type:"SIMPLIFY_SELECTED_ENGLISH",text:e.selectionText}).catch((e=>{}))})),chrome.runtime.onMessage.addListener(((e,n,l)=>{if("translate"===e.action);else if("checkAuth"===e.action){const e=t();return s(e).then((e=>{l({success:!0,authState:e})})).catch((e=>{l({success:!1,error:e.message})})),!0}}));
